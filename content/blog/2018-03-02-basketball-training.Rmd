---
title: Basketball Training
author: Erik-Jan van Kesteren
date: '2018-03-02'
slug: basketball-training
draft: true
categories:
  - R
  - Analysis
tags:
  - R
  - Analysis
  - Dataset
  - Markov
---


```{r setup, include=FALSE, echo=FALSE,render=FALSE,warning=FALSE,background=TRUE, message=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(dev = 'svg')
library(ggplot2)
# edited from
# https://github.com/traffordDataLab/assets/blob/master/theme/ggplot2/theme_lab.R
theme_ej <- function () { 
  theme_grey(base_size = 11.5, base_family = "sans") %+replace% 
    theme(
      # add padding to the plot
      plot.margin = unit(rep(0.5, 4), "cm"),
      # remove the plot background and border
      plot.background = element_blank(),
      panel.background = element_blank(),
      panel.border = element_blank(),
      # make the legend and strip background transparent
      legend.background = element_rect(fill = "transparent", colour = NA),
      legend.key = element_rect(fill = "transparent", colour = NA),
      strip.background = element_rect(fill = "transparent", colour = NA),
      # add light, dotted major grid lines only
      panel.grid.major = element_line(linetype = "dotted", colour = "#757575", size = 0.3),
      panel.grid.minor = element_blank(),
      # remove the axis tick marks and hide axis lines
      axis.ticks = element_blank(),
      axis.line = element_line(color = "#FFFFFF", size = 0.3),
      # modify the bottom margins of the title and subtitle
      plot.title = element_text(size = 18, colour = "#757575", hjust = 0, margin = margin(b = 4)),
      plot.subtitle = element_text(size = 12, colour = "#757575", hjust = 0, margin = margin(b = 10)),
      # add padding to the caption
      plot.caption = element_text(size = 10, colour = "#212121", hjust = 1, margin = margin(t = 15)),
      axis.title = element_text(size = 11, colour = "#757575", face = "plain", hjust = 1),
      axis.text = element_text(size = 10, colour = "#757575", face = "plain"),
      legend.title = element_text(size = 12, colour = "#757575"),
      legend.text = element_text(size = 10, colour = "#757575"),
      strip.text = element_text( size = 12, colour = "#757575", face = "plain")
    )
}
```

## Introduction

I was on holiday and had to wait a while. Fortunately, close to where I was sitting there was a kid playing basketball all by himself. Of course I had to record how many hits and misses he made, to keep it as a nice dataset for further analysis.

Here is the dataset:
```{r init}
b <- c("miss","miss","miss","hit","miss","hit","miss", "miss",
       "hit","hit","miss","miss","miss","miss", "miss","miss",
       "miss","hit","hit","hit","miss","hit")
```

## What can we do with this?
Firstly, we can describe how often the kid hits manages to score a point:

```{r plot, echo = FALSE}
ggplot(data.frame(basket = b), aes(x = basket)) + 
  geom_bar(fill = "#00008B") + 
  labs(x = "Throw", y = "Count") +
  theme_ej()
```

So it looks like the kid misses a bit more than he hits. But there is much more information in this dataset: besides whether the kid hits or misses, we can say something about the _sequence_ of these events. We can do this using a transition matrix;

$$
\begin{bmatrix}
A & B \\
C & D 
\end{bmatrix}
$$
Entering observed probabilities in $\{A, B, C, D\}$ this matrix tells us how likely it is that:

- $A$ a hit is followed by another hit
- $B$ a hit is followed by a miss
- $C$ a miss is followed by a hit
- $D$ a miss is followed by another hit
  
Here is an R function for generating the transition matrix:
```{r transmat}
transMat <- function(x, prob = TRUE) {
  X <- t(as.matrix(x))
  tt <- table( c(X[,-ncol(X)]), c(X[,-1]) )
  if(prob) tt <- tt / rowSums(tt)
  tt
}

m <- transMat(b)
print(m, digits = 2)

```

This transition matrix completely defines the 2-state markov chain. Assuming these probabilities are stable, we can now generate markov processes just like the one we observed. And we can nicely visualise it using [this markov chain generator post](http://setosa.io/ev/markov-chains/) by [setosa](http://setosa.io/ev/). In the image below, A equals a hit, and B equals a miss (Go ahead, play around, it's completely interactive!)

<iframe src="http://setosa.io/markov/index.html#%7B%22tm%22%3A%5B%5B0.43%2C0.57%5D%2C%5B0.36%2C0.64%5D%5D%7D" width="100%" height="350px" style="border:none"></iframe>

_Frame: [Setosa](http://setosa.io/ev/markov-chains/) markov chain visualisation_